{% if section.blocks.size > 0 %}

<style>
/*响应*/
@media (min-width:1366px ) and (max-width: 1920px){
    /*响应
.common-top5-section ul li:nth-child(4n){
  grid-column:1 / 4;
}
.common-top5-section ul li:nth-child(4n + 1){
  grid-column:4 / 7;
}
.common-top5-section ul li:nth-child(4n + 2){
  grid-column:7 / 10;
}
.common-top5-section ul li:nth-child(4n - 1){
  grid-column:10 / 13;
}
.common-top5-section li picture{height: 225px;}
*/
}
@media (min-width:768px ) and (max-width: 1920px){
.common-top5-section ul li:nth-child(3n - 1){
grid-column:9 / 13;
}
.common-top5-section ul li:nth-child(3n){
   grid-column:1 / 5;
}
.common-top5-section ul li:nth-child(3n + 1){
  grid-column:5 / 9; 
}
.common-top5-section li picture{height: 300px;}
.common-top5-section ul li:nth-child(8),.common-top5-section ul li:nth-child(10) {
  grid-column: 1 / 7;
}
.common-top5-section ul li:nth-child(7),.common-top5-section ul li:nth-child(9),.common-top5-section ul li:nth-child(11){
  grid-column: 7 / 13; 
}
}
/*--框架布局--*/
.common-top5-section{
  font-size:1.5rem;
  background: #f9f9f9;
}

.common-top5-section picture{
  display:block;
  text-align: center;
}  
.common-top5-section ul {        
    display: grid;    
    grid-gap: 10px;
    grid-template-columns: repeat(12, 1fr);
    grid-template-rows: 370px 320px 320px 370px;
    overflow: hidden
}
.common-top5-section ul li{
  overflow: hidden;
  position: relative;
  background: #fff;
}
.common-top5-section ul li:nth-of-type(n + 8) picture{
  display: flex;
  align-items: center;
}
.common-top5-section ul li:nth-child(1),.common-top5-section ul li:nth-child(6) {
  grid-column: 1 / 7;
}
.common-top5-section ul li:nth-child(2){
  grid-column: 7 / 13; 
}
.common-top5-section ul li:nth-child(3){
  grid-row: 2 / 4;
  grid-column:1 / 5;
}
.common-top5-section ul li:nth-child(4),.common-top5-section ul li:nth-child(5){
  grid-column:  5 / 13;
}
/*--布局结束--*/
/*--产品样式--*/
/*
* 公共样式 3||4
*/
.common-top5-section .item .five-toplabel{
  position: absolute;
  top: .84rem;
  left: 1.25rem;
  width: 5.3rem;
  height: 5.3rem;
  border-radius: 50%;
  background: #fb033c;
  align-items: center;
  justify-content: center;
  line-height: 1.67rem;
  color: #fff;
  font-size: 1.3rem;
  z-index: 1;
  display: flex;
  flex-direction: column;
  display: -webkit-flex;
  -webkit-flex-direction: column;
}
.common-top5-section .item .five-toplabel span{
  font-weight: 600;
  font-size: 1.5rem;
}
.common-top5-section ul li.image img {
  width: 100%;
}
.common-top5-section ul li.image picture {
  width: 100%;
  overflow: visible;
}
.common-top5-section li picture{
  overflow: hidden;
  width: 80%;
  margin: 0 auto;  
}
.common-top5-section li picture img{
  width: auto;
}
.common-top5-section .detail .sold{
  color: #fb033c;
  font-size: 1.2rem;
  margin-bottom: 10px;
}
.common-top5-section .detail .title{
    overflow: hidden;
    height: 3.3rem;
    font-size: 1.3rem;
    color: #000;
    width: 79%;
    display: block;
    line-height: 1.2;
}
.common-top5-section .detail {    
    min-height:7rem;
    margin-top: 0;
    margin-bottom: 1rem;
    padding-left: 10%;
    width: 90%;
    z-index: 1;
    display: grid;
    align-items: center;
}
.common-top5-section .detail .price .price_sale{
  font-size: 1.2rem;
  color: #fb033c;
  margin-right: 5px;
}
.common-top5-section .detail .price .price_compare{
  font-size: 1.2rem;
  text-decoration: line-through;
  color: #000;
}
.common-top5-section .detail button{
  background: #fb033c;
  padding: 5px 17px;
  color: #fff;
  border: none;
  margin-top: 10px;
  text-transform: uppercase;
  display: block;
  text-align: center;
  width:8rem;
}
/*
* 前七个产品
*/
.common-top5-section ul li:nth-child(2) picture,.common-top5-section ul li:nth-child(7) picture,.common-top5-section ul li:nth-child(1) picture,.common-top5-section ul li:nth-child(6) picture{
  width: 100%;
  height: auto;
  min-height: 260px;
}
.common-top5-section ul li:nth-child(2) picture img,.common-top5-section ul li:nth-child(7) picture img,.common-top5-section ul li:nth-child(1) picture img,.common-top5-section ul li:nth-child(6) picture img{
  width: 44%;
}
.common-top5-section ul li.image:nth-child(2) picture img,.common-top5-section ul li.image:nth-child(7) picture img,.common-top5-section ul li.image:nth-child(1) picture img,.common-top5-section ul li.image:nth-child(6) picture img{
  width: 100%;
}
.common-top5-section ul li:nth-child(2) .sold,.common-top5-section ul li:nth-child(7) .sold,.common-top5-section ul li:nth-child(1) .sold,.common-top5-section ul li:nth-child(6) .sold{
  margin-bottom: 1rem;
}
.common-top5-section ul li:nth-child(2) .title,.common-top5-section ul li:nth-child(7) .title,.common-top5-section ul li:nth-child(1) .title,.common-top5-section ul li:nth-child(6) .title{
  margin-bottom: 0;
  grid-column: 1/13;
}
.common-top5-section ul li:nth-child(2) .price,.common-top5-section ul li:nth-child(7) .price,.common-top5-section ul li:nth-child(1) .price,.common-top5-section ul li:nth-child(6) .price,.common-top5-section ul li:nth-child(8) .price,.common-top5-section ul li:nth-child(9) .price,.common-top5-section ul li:nth-child(10) .price,.common-top5-section ul li:nth-child(11) .price{
  display: inline-block;
  grid-column: 1 / 10;
}
.common-top5-section ul li:nth-child(2) button,.common-top5-section ul li:nth-child(7) button,.common-top5-section ul li:nth-child(1) button,.common-top5-section ul li:nth-child(6) button,.common-top5-section ul li:nth-child(8) button,.common-top5-section ul li:nth-child(9) button,.common-top5-section ul li:nth-child(10) button,.common-top5-section ul li:nth-child(11) button{
  display: inline-block;
    grid-column: 11 / 13;
    margin: 0;
    padding: .5rem 1rem;
}
.common-top5-section ul li:nth-child(3) picture{
  width: 100%;
  height: auto;
  padding-top: 10%;
}
.common-top5-section ul li:nth-child(3) picture img{
  width: auto;
  max-width: 100%;
}
.common-top5-section ul li:nth-child(3) .detail{
  position: absolute;
  left: 0;
  bottom: 9%;  
  display: block;
}
.common-top5-section ul li:nth-child(4) a .detail .title,.common-top5-section ul li:nth-child(5) a .detail .title ,.common-top5-section ul li:nth-child(3) .detail .title {
    margin-bottom:1.2rem
}
.common-top5-section ul li:nth-child(4) a,.common-top5-section ul li:nth-child(5) a{
  display: flex;
  align-items: center;
}

.common-top5-section ul li.image:nth-child(4) picture,.common-top5-section ul li.image:nth-child(5) picture{
  width: 100%;
}
.common-top5-section ul li:nth-child(4) picture,.common-top5-section ul li:nth-child(5) picture{
  display: inline-block;
  width: 40%;
  height: auto;
}
.common-top5-section ul li:nth-child(4) .detail,.common-top5-section ul li:nth-child(5) .detail{
  display: inline-block;
  width: 45%;
  padding-left: 5%;
}
@media only screen and (min-device-width : 768px) and (max-device-width : 1024px) and (orientation : portrait){
.common-top5-section ul{
  grid-template-rows: auto;
}
.common-top5-section ul li:nth-child(2) picture, .common-top5-section ul li:nth-child(7) picture, .common-top5-section ul li:nth-child(1) picture, .common-top5-section ul li:nth-child(6) picture,.common-top5-section ul li:nth-child(6) picture{
  min-height: 200px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.common-top5-section .detail .title{
  height: 56px;
  width: 100%;
}
.common-top5-section ul li:nth-child(3) .detail{position: unset;}
.common-top5-section .item .five-toplabel{
  height: 40px;
  width: 40px;
  left: 10px;
  line-height: 1;
}
.common-top5-section .item .five-toplabel span{
  font-size: 13px;
}
}
@media only screen and (min-device-width : 768px) and (max-device-width : 1024px) and (orientation : landscape){
.common-top5-section .detail .title{font-size:14px;}
.common-top5-section ul li:nth-child(2) picture, .common-top5-section ul li:nth-child(7) picture, .common-top5-section ul li:nth-child(1) picture, .common-top5-section ul li:nth-child(6) picture{
	min-height:260px;
}
}
@media(max-width:640px){
.common-top5-section ul li:nth-child(2) .price, .common-top5-section ul li:nth-child(7) .price, .common-top5-section ul li:nth-child(1) .price, .common-top5-section ul li:nth-child(6) .price{  margin: 1rem 0; }
.common-top5-section ul li.item picture{min-height: auto;width: 50%;}
.common-top5-section ul li.item picture img {width: 100%;}
.common-top5-section ul li.item .detail{width: 48%;}
.common-top5-section ul li.item:nth-child(1),.common-top5-section ul li.item:nth-child(2),.common-top5-section ul li.item:nth-child(3),.common-top5-section ul li.item:nth-child(4),.common-top5-section ul li.item:nth-child(5),.common-top5-section ul li.item:nth-child(6){grid-column: 1 / 3;text-align: left;display: flex;align-items: center;}
.common-top5-section ul li.item:nth-child(1) a,.common-top5-section ul li.item:nth-child(2) a,.common-top5-section ul li.item:nth-child(3) a,.common-top5-section ul li.item:nth-child(4) a,.common-top5-section ul li.item:nth-child(5) a,.common-top5-section ul li.item:nth-child(6) a{ display: flex;align-items: center;
    padding-right: 2%;}
.common-top5-section ul{grid-template-rows: auto;grid-template-columns:50% 50%;    padding: 0;}
.common-top5-section .detail{min-height: auto;padding-left: 8%;padding-top: 6%;
    display: initial;}
.common-top5-section .detail .price{ margin:1rem 0}
.common-top5-section .detail .sold{font-size: 12px;}
.common-top5-section .detail .title{font-size: 12px;width: 100%;height:auto;}
.common-top5-section .detail .price .price_sale{color: #b51e11;font-size: 18px;font-weight: 600;}
.common-top5-section .detail .price .price_compare{font-size: 12px;}
.common-top5-section .detail button{background: #ea3323;border-radius: 4px;;width:auto;
    padding: .5rem 1rem;}
.common-top5-section ul li.item.image:nth-child(1){display: none;}
.common-top5-section ul li:nth-child(3){grid-row: auto;}
.common-top5-section ul li:nth-child(3) picture{padding-top: 0;}
.common-top5-section ul li:nth-child(3) .detail{position: unset;}
.common-top5-section li picture{margin: 0;}
.common-top5-section ul li.item:nth-of-type(n + 7) picture{width: 100%;min-height:157px;}
.common-top5-section ul li.item:nth-of-type(n + 7) picture img { width: 90%;margin: 0 auto}
.common-top5-section ul li.item:nth-of-type(n + 7) .detail{width: 100%;padding-left: 0;text-align:center;}
.common-top5-section ul li.item:nth-of-type(n + 7) .detail .title{margin-bottom: 0;    padding: 0 10px;}
.common-top5-section ul li.item:nth-of-type(n + 7) .detail .price{display: flex;justify-content: center;flex-flow: row-reverse;align-items: flex-end;}
.common-top5-section ul li.item:nth-of-type(n + 7) .detail .price .price_sale{font-size: 13px;
    margin-left: 5px;}
.common-top5-section ul li.item:nth-of-type(n + 7) .detail button {display: none;}
.common-top5-section ul li.item:nth-child(1) a,.common-top5-section ul li.item:nth-child(3) a,.common-top5-section ul li.item:nth-child(5) a{flex-flow: row-reverse;padding-left: 2%}
.common-top5-section ul li.item:nth-child(2),.common-top5-section ul li.item:nth-child(4),.common-top5-section ul li.item:nth-child(6){}
.common-top5-section .item .five-toplabel{width: 40px;height: 40px;line-height: 1;top: 10px;left: 15px;}
.common-top5-section .item .five-toplabel span{font-weight: 400;font-size: 14px;}
.common-top5-section ul li.item:nth-child(1) .five-toplabel,.common-top5-section ul li.item:nth-child(3) .five-toplabel,.common-top5-section ul li.item:nth-child(5) .five-toplabel{left: unset;right: 15px;}
}
</style>

{% for block in section.blocks %}

      {% comment %} 校验规则 {% endcomment %}
      {% unless block.settings.check == 'nocheck' %}
        {% if block.settings.check == 'product' %}
          {%- include 'func-verify_rules', contain: block.settings.contain, detail: product -%}
        {% elsif block.settings.check == 'collection' %}
          {%- include 'func-verify_rules', contain: block.settings.contain, detail: collection -%}
        {% elsif block.settings.check == 'page' %}
          {%- include 'func-verify_rules', contain: block.settings.contain, detail: page -%}
        {% endif %}

        {% if verify__rules_result == false %}
        {% continue %}
        {% endif %}
      {% endunless %}

      {% assign current_collection = collections[block.settings.collection] %}
      {% assign i = 0 %}
      {% if current_collection.products.size > 0%}
        {% unless block.settings.before_html == blank %}
        <div class="before_html">{{block.settings.before_html}}</div>
        {% endunless %}
        <ul class="page-width">
          {% for item in current_collection.products limit: block.settings.limit %}
            {% assign firstVariant = item.first_available_variant %}
            {% assign position = block.settings.position | default: 0 %}
            {% assign image = item.images[position]%}
            {% assign i = i | plus: 1 %}

            {% if forloop.first == true and block.settings.image != blank %}
            {% assign resize = block.settings.image.width | append: 'x' | append: block.settings.image.height %}
            <li class="item image">
              <a href="{{current_collection.products[0].url}}">
                <picture>
                    <img
                        data-src="{{ block.settings.image | img_url: resize }}"
                        class="lazyload"
                        alt="{{ block.settings.image.alt | escape }}" />
                </picture>
              </a>
            </li>
            {% endif %}

            <li class="item product">
              <a href="{{item.url}}">
                <div class="five-toplabel flex-between-colom">
                    <span class="fw">TOP</span>
                    <span class="fw fs14">{% if i < 10 %}0{% endif %}{{ i }}</span>
                </div>
                <picture>
                    <img
                        data-src="{{ image | img_url: '340x' }}"
                        class="lazyload"
                        alt="{{ image.alt | escape }}" />
                </picture>
                <div class="detail">
                    {% unless item.metafields.global.sold == blank %}
                    <div class="sold"> {{item.metafields.global.sold}}{{ 'common.top5.pcs_sold' | t }}</div>
                    {% endunless %} 
                    <div class="title">{{item.title}}</div>
                    <div class="price">
                      <span class="price_sale" data-money="{{ firstVariant.price }}"></span>
                      <span class="price_compare" data-money="{{ firstVariant.compare_at_price }}"></span>
                    </div>
                    <button>{{ 'common.top5.buy_now' | t }}</button>
                </div>
              </a>
            </li>
          {% endfor %}      
        </ul>
        {% unless block.settings.after_html == blank %}
        <div class="after_html">{{block.settings.after_html}}</div>
        {% endunless %}
      {% endif %}
{% endfor %}



{% endif %}
{% schema %} 
{
  "name": "通用 - TOP5产品列表",
  "class":"common-top5-section",
  "settings": [
    {
      "type": "header",
      "content": "应用范围 - 首页，分类页，产品页，page页，以及购物车页面"
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "添加TOP", 
      "settings": [
        {
          "type": "checkbox",
          "id": "enable",
          "label": "开启",
          "default": true
        },
        {
          "type": "html",
          "id": "before_html",
          "label": "块之前的额外的HTML"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "添加主图"
        },
        {
          "type": "select",
          "id": "check",
          "label": "判断条件的目标",
          "options": [
            {
              "value": "nocheck",
              "label": "不验证"
            },
            {
              "value": "product",
              "label": "产品页"
            },
            {
              "value": "collection",
              "label": "分类页"
            },
            {
              "value": "page",
              "label": "page页"
            }
          ],
          "default": "nocheck",
          "info": "这个需要配合下面的'包含的条件'， 来结合使用"
        },
        {
          "type": "textarea",
          "id": "contain",
          "label": "包含的条件",
          "info": "{\"handle\": \"\",\"tags\": \"Test Product2\",\"vendor\": \"\",\"type\": \"watch\",\"sku\": \"TEST004\"}"
        },
        {
          "type": "collection",
          "id": "collection",
          "label": "选择集合"
        },
        {
          "type": "range",
          "id": "limit",
          "label": "产品limit总数量",
          "min": 1,
          "max": 100,
          "step": 1,
          "default": 5
        },
        {
          "type": "html",
          "id": "after_html",
          "label": "块之后的额外的HTML"
        }
      ]
    }
  ],
  "presets": [{
		"name": "通用 - TOP5产品列表",
		"category": "通用"
	}]
}
{% endschema %}

